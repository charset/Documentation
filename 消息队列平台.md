# 消息队列平台

### 基本概念

#### 1. 服务 Service

服务**必须**至少有两类角色，一类是称为“服务提供者”，一类是为“服务消费者”。

##### 服务间的角色存在契约关系。

一般来说，服务从起始到终止（结束），存在着下列属性（排名不分先后）：

###### 服务质量（Quality Of Service ：QoS）

因为服务双方角色差异性，提供服务质量的差异。如提供客户信息的A系统负载过高，则可暂时可由相同数据集的系统B来替代或者延长排队时间、拒绝服务、熔断等机制来保护信息系统，提升整个系统环境的质量，不至于由于单点服务故障导致的整体系统服务延迟。

###### 服务控制（Service Control）

在一个组织内部，由于权限和数据保护的考虑，对服务消费者允许的服务目录进行控制。如企业服务总线（ESB），对各个服务消费者访问的服务提供者进行访问路由控制。

###### 服务契约（Service Contract）

服务双方必须商定服务中使用的字段，通讯手段，通讯时间等因素。对于ESB承载基于HTTP的Web Service来说，这些因素已经写入WSDL定义文件，ESB会依赖于这些因素去连接上方并转接服务。服务契约也可称为“服务合同”。

##### 服务过程中还伴随业务状态变化。

如客户开设银行帐号服务，需要在银行柜面申请。结果是客户资料维护在银行内部，并且银行系统为客户建立客户号。这些服务的结果必须对客户负责。以下动词体现了业务状态变化。

###### A client *HAS* a bank account.

###### The bank *HAS* the client's information.

###### The bank *PROVIDES* an account for the client.

#### 2. 消息

消息**可以**分为两类角色，一类称为“消息提供者”，一类成为“消息接收者”。从字面上来说，消息并不像服务一样要求双方的契约。顾名思义，消息是“提供者”用来通知“接收者”的信息载体。

##### 消息有失效时间的属性。

对于服务来说，服务没有失效时间的属性。因为服务双方已经按照服务契约约定了超时时间，超时后可经由补偿机制再次约定服务周期。消息在失效时间过后，就没有任何意义，消息接收者在接收此消息后可直接删除，不做任何业务处理。

##### 消息适用的场景。

1. 客户申请贷款流程通知。客户在流程内部节点变更时会及时收到通知，而且一般客户并不会在收到此通知后还要登录信贷或者网银去查看自己的流程详细状态。此流程节点的状态还是保留在贷款系统内部。

2. 账务变动通知。可做更复杂的逻辑。将此模块从短信平台剥离出来，形成企业内部的通知平台。如果核心系统提供数据支持，还能做到普通账户级、子母账户级的通知。让专业的平台做专业的事情。